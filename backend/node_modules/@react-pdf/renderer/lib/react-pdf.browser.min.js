import*as e from"@react-pdf/primitives";export*from"@react-pdf/primitives";import r from"queue";import{useRef as t,useState as o,useEffect as n,useCallback as i}from"react";import a from"@react-pdf/font";import l from"@react-pdf/render";import c from"@react-pdf/pdfkit";import s from"@react-pdf/layout";import d from"@react-pdf/reconciler";import{jsx as p}from"react/jsx-runtime";const u=(e,r)=>{let{style:t,children:o,...n}=r;return{type:e,box:{},style:t||{},props:n||{},children:[]}},f=e=>({type:"TEXT_INSTANCE",value:e}),m=(e,r)=>{const t="TEXT"===e.type||"LINK"===e.type||"TSPAN"===e.type||"NOTE"===e.type;"TEXT_INSTANCE"!==r.type||t?e.children.push(r):console.warn(`Invalid '${r.value}' string child outside <Text> component`)},v=(e,r)=>{"ROOT"===e.type?e.document=r:m(e,r)},h=(e,r,t)=>{var o;const n=null===(o=e.children)||void 0===o?void 0:o.indexOf(t);void 0!==n&&-1!==n&&r&&e.children.splice(n,0,r)},b=(e,r)=>{var t;const o=null===(t=e.children)||void 0===t?void 0:t.indexOf(r);void 0!==o&&-1!==o&&e.children.splice(o,1)},y=(e,r)=>{var t;const o=null===(t=e.children)||void 0===t?void 0:t.indexOf(r);void 0!==o&&-1!==o&&e.children.splice(o,1)},g=(e,r,t)=>{e.value=t},w=(e,r,t,o,n)=>{const{style:i,...a}=n;e.props=a,e.style=i},T=e=>{let{onChange:r=(()=>{})}=e;return d({appendChild:m,appendChildToContainer:v,commitTextUpdate:g,commitUpdate:w,createInstance:u,createTextInstance:f,insertBefore:h,removeChild:b,removeChildFromContainer:y,resetAfterCommit:r})};var C={name:"@react-pdf/renderer",version:"4.1.5",license:"MIT",description:"Create PDF files on the browser and server",author:"Diego Muracciole <diegomuracciole@gmail.com>",homepage:"https://github.com/diegomura/react-pdf#readme",type:"module",main:"./lib/react-pdf.js",browser:{"./lib/react-pdf.js":"./lib/react-pdf.browser.js"},repository:{type:"git",url:"https://github.com/diegomura/react-pdf.git",directory:"packages/renderer"},scripts:{build:"rimraf ./lib && rollup -c",watch:"rimraf ./lib && rollup -c -w",size:"size-limit",lint:"eslint src",test:"vitest && vitest --config vitest.browser.config.js"},dependencies:{"@babel/runtime":"^7.20.13","@react-pdf/font":"^3.0.1","@react-pdf/layout":"^4.1.3","@react-pdf/pdfkit":"^4.0.0","@react-pdf/primitives":"^4.0.0","@react-pdf/reconciler":"^1.1.3","@react-pdf/render":"^4.0.2","@react-pdf/types":"^2.7.0",events:"^3.3.0","object-assign":"^4.1.1","prop-types":"^15.6.2",queue:"^6.0.1"},peerDependencies:{react:"^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0"},"lint-staged":{"*.js":["yarn lint","prettier --write"]},files:["lib","index.d.ts"],collective:{type:"opencollective",url:"https://opencollective.com/react-pdf",logo:"https://opencollective.com/opencollective/logo.txt"},devDependencies:{"@size-limit/preset-big-lib":"^11.0.1",assert:"^2.0.0","browserify-zlib":"^0.2.0",buffer:"^6.0.3",process:"^0.11.10","size-limit":"^11.0.1",util:"^0.12.4"}};const{version:D}=C,S=new a;let N;const A={},O=e=>{const r={type:"ROOT",document:null};N=N||T({onChange:()=>{var e;const r=(null===(e=A.change)||void 0===e?void 0:e.slice())||[];for(let e=0;e<r.length;e+=1)r[e]()}});const t=N.createContainer(r),o=(e,r)=>{N.updateContainer(e,t,null,r)};e&&o(e);const n=async function(e){void 0===e&&(e=!0);const t=r.document.props||{},{pdfVersion:o,language:n,pageLayout:i,pageMode:a,title:d,author:p,subject:u,keyboards:f,creator:m="react-pdf",producer:v="react-pdf",creationDate:h=new Date,modificationDate:b}=t,y=new c({compress:e,pdfVersion:o,lang:n,displayTitle:!0,autoFirstPage:!1,pageLayout:i,pageMode:a,info:(g={Title:d,Author:p,Subject:u,Keywords:f,Creator:m,Producer:v,CreationDate:h,ModificationDate:b},Object.fromEntries(Object.entries(g).filter((e=>{let[,r]=e;return void 0!==r}))))});var g;const w=await s(r.document,S);return{layout:w,fileStream:l(y,w)}},i=function(e){void 0===e&&(e={}),r.document.props.onRender&&r.document.props.onRender(e)};return{on:(e,r)=>{A[e]||(A[e]=[]),A[e].push(r)},container:r,toBlob:async()=>{const e=[],{layout:r,fileStream:t}=await n();return new Promise(((o,n)=>{t.on("data",(r=>{e.push(r instanceof Uint8Array?r:new Uint8Array(r))})),t.on("end",(()=>{try{const t=new Blob(e,{type:"application/pdf"});i({blob:t,_INTERNAL__LAYOUT__DATA_:r}),o(t)}catch(e){n(e)}}))}))},toBuffer:async()=>{const{layout:e,fileStream:r}=await n();return i({_INTERNAL__LAYOUT__DATA_:e}),r},toString:async()=>{"development"===process.env.NODE_ENV&&console.warn("`toString` is deprecated and will be removed in next major release");let e="";const{fileStream:r}=await n(!1);return new Promise(((t,o)=>{try{r.on("data",(r=>{e+=r})),r.on("end",(()=>{i(),t(e)}))}catch(e){o(e)}}))},removeListener:(e,r)=>{if(!A[e])return;const t=A[e].indexOf(r);t>-1&&A[e].splice(t,1)},updateContainer:o}},L=S,_={create:e=>e},j=function(e){let{document:a}=void 0===e?{}:e;const l=t(null),[c,s]=o({url:null,blob:null,error:null,loading:!!a});n((()=>{const e=r({autostart:!0,concurrency:1}),t=()=>{s((e=>({...e,loading:!0}))),e.splice(0,e.length,(()=>c.error?Promise.resolve():l.current.toBlob()))};return l.current=O(),l.current.on("change",t),a&&l.current.updateContainer(a),e.on("error",(e=>{console.error(e),s((r=>({...r,loading:!1,error:e})))})),e.on("success",(e=>{s({blob:e,error:null,loading:!1,url:URL.createObjectURL(e)})})),()=>{e.end(),l.current.removeListener("change",t)}}),[]),n((()=>()=>{c.url&&URL.revokeObjectURL(c.url)}),[c.url]);const d=i((e=>{l.current.updateContainer(e)}),[]);return[c,d]},x=e=>{let{title:r,style:t,className:o,children:i,innerRef:a,showToolbar:l=!0,...c}=e;const[s,d]=j();n((()=>d(i)),[i]);const u=s.url?`${s.url}#toolbar=${l?1:0}`:null;return p("iframe",{src:u,title:r,ref:a,style:t,className:o,...c})},P=e=>{let{document:r,children:t}=e;const[o,i]=j();return n((()=>i(r)),[r]),r?t(o):(console.warn("You should pass a valid document to BlobProvider"),null)},E=e=>{let{fileName:r="document.pdf",document:t,children:o,onClick:i,href:a,...l}=e;const[c,s]=j();if(n((()=>s(t)),[t]),!t)return console.warn("You should pass a valid document to PDFDownloadLink"),null;return p("a",{href:c.url,download:r,onClick:e=>{c&&window.navigator.msSaveBlob&&window.navigator.msSaveBlob(c.blob,r),"function"==typeof i&&i(e,c)},...l,children:"function"==typeof o?o(c):o})},R=e=>{throw new Error(`${e} is a Node specific API. You're either using this method in a browser, or your bundler is not loading react-pdf from the appropriate web build.`)},B=()=>{R("renderToStream")},F=()=>{R("renderToBuffer")},I=()=>{R("renderToString")},U=()=>{R("renderToFile")},k=()=>{R("render")};var z={pdf:O,usePDF:j,Font:L,version:D,StyleSheet:_,PDFViewer:x,BlobProvider:P,PDFDownloadLink:E,renderToStream:B,renderToString:I,renderToFile:U,render:k,...e};export{P as BlobProvider,L as Font,E as PDFDownloadLink,x as PDFViewer,_ as StyleSheet,T as createRenderer,z as default,O as pdf,k as render,F as renderToBuffer,U as renderToFile,B as renderToStream,I as renderToString,j as usePDF,D as version};
